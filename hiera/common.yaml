classes:
  - sites
  - sites::faalkaart

# site config
sites::realm: faalserver.faalkaart.nl
sites::mysql_root_pw: changeme
sites::default_vhost_content: faal

# letsencrypt account settings
letsencrypt::email: info@faalkaart.nl

# nginx default config
nginx::config::fastcgi_cache_path: /var/www/cache/
nginx::config::fastcgi_cache_key: '"$scheme$request_method$host$request_uri"'
nginx::config::fastcgi_cache_keys_zone: default:250m
nginx::config::fastcgi_cache_max_size: 500m
nginx::config::fastcgi_cache_inactive: 30m
nginx::config::log_format:
  cache: "$remote_addr - $upstream_cache_status [$time_local] $request $status $body_bytes_sent $http_referer $http_user_agent"


# users & sudo permissions
accounts::users:
  test:
    ensure: absent
  aequitas:
    sudo: true
    keys:
      key1:
        type: ssh-rsa
        key: AAAAB3NzaC1yc2EAAAABIwAAAQEAzTqFM62DY6nnBSEpO6lnFp80cAqs12rIfZ9iDZh/TvXuvVgrsKPaKTM5fLiulH+CntCxjmywEochYrLUiq2RnVVaoKGQsdRdCY9UGNhAK5l4v+5V5DiZBxVCEgfYwIdw1Jya+vMGKxhZ0VQprj5Yw98OfwvyX5ZksIJnHevNW+gYkeZtr0D8ETatx2ph7JI34bkSOQG607aaed8YB2U7oziTHiiuD553bSoVP26HozhLViliLGaGNOdhLZR8ionZKmc6zCrzSDb2iGPUOdjalYVxi9sqLjHwo0Mfj40AzsRYEhJ1E0LrTNA3pSjJULCWdheDEjzXpUViJlvN/2/HhQ==

# basic firewall config
firewall:
  100 allow related, established:
    proto: all
    state:
      - RELATED
      - ESTABLISHED
    action: accept
  100 allow icmp:
    proto: icmp
    action: accept
  100 allow local:
    proto: all
    iniface: lo
    action: accept
  200 allow ssh:
    dport: ssh
    action: accept
  300 allow http traffic in:
    dport: http
    action: accept
  300 allow https traffic in:
    dport: https
    action: accept
  999 drop the rest:
    action: drop
  # ipv6
  100 v6 allow related, established:
    proto: all
    state:
      - RELATED
      - ESTABLISHED
    action: accept
    provider: ip6tables
  100 v6 allow icmp:
    proto: icmp
    action: accept
    provider: ip6tables
  100 v6 allow local:
    proto: all
    iniface: lo
    action: accept
    provider: ip6tables
  200 v6 allow ssh:
    dport: ssh
    action: accept
    provider: ip6tables
  300 v6 allow http traffic in:
    dport: http
    action: reject
    provider: ip6tables
  300 v6 allow https traffic in:
    dport: https
    action: reject
    provider: ip6tables
  999 v6 drop the rest:
    action: drop
    provider: ip6tables

# ssh server configuration
# https://forge.puppetlabs.com/saz/ssh#hiera-example
ssh::storeconfigs_enabled: false
ssh::server_options:
  PasswordAuthentication: 'no'
